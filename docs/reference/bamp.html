<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian Age-Period-Cohort Modeling and Prediction (bamp) — bamp • bamp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bayesian Age-Period-Cohort Modeling and Prediction (bamp) — bamp" />
<meta property="og:description" content="Bayesian Age-Period-Cohort Modeling for the analyze of incidence or mortality data on the Lexis diagram.
For each pixel in the Lexis diagram (that is for a specific age group and specific period) data must be available on the number of persons under risk (population number) and the number of disease cases (typically cancer incidence or mortality).
A hierarchical model is assumed with a binomial model in the first-stage. As smoothing priors for the age, period and cohort parameters random walks of first and second order (RW1 or RW2) available.
Deviance information criterion and effective number of parameters is computed for model comparison.
Note that there is a non-identifiability in the likelihood of the APC-model, see e.g. Clayton and Schifflers (1987, DOI:10.1002/sim.4780060406), which indices some problems in interpreting the latent effects. Only for RW1 model, the parameters are (weakly) identifiable.
Period and age groups do not need to be on the same grid, for example periods can be in one year intervals and age groups in five year intervals.
Additionally to the model described in Knorr-Held and Rainer (2001, DOI:10.1093/biostatistics/2.1.109), bamp can handle
models with and without global heterogeneity parameter (overdispersion),
models with additional age, period and/or cohort heterogeneity,
additional covariates.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../articles/standaloneversion/index.html">Standalone Version</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/volkerschmid/bamp">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/vjsstat">
    <span class="fas fa-twitter"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian Age-Period-Cohort Modeling and Prediction (bamp)</h1>
    <small class="dont-index">Source: <a href='https://github.com/volkerschmid/bamp/blob/master/R/bamp.R'><code>R/bamp.R</code></a></small>
    <div class="hidden name"><code>bamp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Bayesian Age-Period-Cohort Modeling for the analyze of incidence or mortality data on the Lexis diagram.
For each pixel in the Lexis diagram (that is for a specific age group and specific period) data must be available on the number of persons under risk (population number) and the number of disease cases (typically cancer incidence or mortality).
A hierarchical model is assumed with a binomial model in the first-stage. As smoothing priors for the age, period and cohort parameters random walks of first and second order (RW1 or RW2) available.
Deviance information criterion and effective number of parameters is computed for model comparison.
Note that there is a non-identifiability in the likelihood of the APC-model, see e.g. Clayton and Schifflers (1987, DOI:10.1002/sim.4780060406), which indices some problems in interpreting the latent effects. Only for RW1 model, the parameters are (weakly) identifiable.
Period and age groups do not need to be on the same grid, for example periods can be in one year intervals and age groups in five year intervals.<br />
Additionally to the model described in Knorr-Held and Rainer (2001, DOI:10.1093/biostatistics/2.1.109), <code>bamp</code> can handle</p><ul>
<li><p>models with and without global heterogeneity parameter (overdispersion),</p></li>
<li><p>models with additional age, period and/or cohort heterogeneity,</p></li>
<li><p>additional covariates.</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>bamp</span><span class='op'>(</span>
  <span class='va'>cases</span>,
  <span class='va'>population</span>,
  <span class='va'>age</span>,
  <span class='va'>period</span>,
  <span class='va'>cohort</span>,
  overdisp <span class='op'>=</span> <span class='cn'>FALSE</span>,
  period_covariate <span class='op'>=</span> <span class='cn'>NULL</span>,
  cohort_covariate <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>periods_per_agegroup</span>,
  mcmc.options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>number_of_iterations <span class='op'>=</span> <span class='fl'>1e+05</span>, burn_in <span class='op'>=</span> <span class='fl'>50000</span>, step <span class='op'>=</span> <span class='fl'>50</span>, tuning
    <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>,
  hyperpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.5</span><span class='op'>)</span>, period <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5e-04</span><span class='op'>)</span>, cohort <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5e-04</span><span class='op'>)</span>, overdisp
    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>,
  dic <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cases</th>
      <td><p>number of cases</p></td>
    </tr>
    <tr>
      <th>population</th>
      <td><p>population number</p></td>
    </tr>
    <tr>
      <th>age</th>
      <td><p>prior for age groups ("rw1", "rw2", "rw1+het", "rw2+het", " ")</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>prior for periods ("rw1", "rw2", "rw1+het", "rw2+het", " ")</p></td>
    </tr>
    <tr>
      <th>cohort</th>
      <td><p>prior for cohorts ("rw1", "rw2", "rw1+het", "rw2+het", " ")</p></td>
    </tr>
    <tr>
      <th>overdisp</th>
      <td><p>logical, add overdispersion to model</p></td>
    </tr>
    <tr>
      <th>period_covariate</th>
      <td><p>covariate for period</p></td>
    </tr>
    <tr>
      <th>cohort_covariate</th>
      <td><p>covariate for cohort</p></td>
    </tr>
    <tr>
      <th>periods_per_agegroup</th>
      <td><p>periods per age group</p></td>
    </tr>
    <tr>
      <th>mcmc.options</th>
      <td><p>list of options for MCMC.</p><ul>
<li><p>burn_in: number of iterations used as burnin at the beginning of the algorithm, these iterations will be removed.</p></li>
<li><p>step: Step size, for example default is 50, so only every 50th iterations will be stored.</p></li>
<li><p>tuning: number of iterations for automatic tuning. Depending on the model, the MCMC algorithm will tune certain parameters for more efficient MCMC chains. After tuning, the algorithm is restarted.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>hyperpar</th>
      <td><p>list of hyper parameters. The hyper prior for the precision (inverse variance) in the random walk priors is a Gamma distribution with parameters \(a\) and \(b\); expected value is \(a/b\), variance is \(a/b^2\). Weak hyper parameters are suggested, defaults are \(a=1, b=0.0005\) for age, period and cohort effects and \(a=1, b=0.05\) for overdispersion (if added).</p></td>
    </tr>
    <tr>
      <th>dic</th>
      <td><p>logical. If true. DIC will be computed</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>logical, should computation be done in parallel. This uses the parallel package, which does not allow parallel computing under Windows.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>verbose mode</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This functions returns an <code><a href='apc.html'>apc</a></code> object. 
Only samples from the posterior are computed, point estimates and credible intervals will be computed in <code><a href='effects.apc.html'>effects.apc</a></code>, <code><a href='print.apc.html'>print.apc</a></code> and <code><a href='plot.apc.html'>plot.apc</a></code>.
<code><a href='predict_apc.html'>predict_apc</a></code> can be used for for prediction of the future rates and number of cases and for a retrospective prediction for model checking.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://volkerschmid.github.io/bamp/articles/largevignettes/modeling.html'>vignette("modeling", package = "bamp")</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>apc</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'>bamp</span><span class='op'>(</span><span class='va'>cases</span>, <span class='va'>population</span>, age<span class='op'>=</span><span class='st'>"rw1"</span>, period<span class='op'>=</span><span class='st'>"rw1"</span>, cohort<span class='op'>=</span><span class='st'>"rw1"</span>, periods_per_agegroup <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Volker Schmid.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


